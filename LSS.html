<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="Landmark Software Solutions - Internship Attestation Certificate" />
		<meta name="theme-color" content="#b53761" />
		<title>Landmark Software Solutions - Internship Certificate</title>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
		<style>
			:root {
				--primary-color: #b53761;
				--secondary-color: #283351;
				--accent-color: #ef7d7a;
				--gold-color: #d4af37;
				--text-dark: #1a1a1a;
				--text-light: #666;
				--border-color: #e0e0e0;
				--shadow: 0 4px 20px rgba(0,0,0,0.1);
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: 'Inter', sans-serif;
				background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
				color: var(--text-dark);
				line-height: 1.6;
				min-height: 100vh;
			}

			.certificate-container {
				max-width: 210mm;
				min-height: 297mm;
				margin: 10px auto;
				background: white;
				box-shadow: var(--shadow);
				position: relative;
				overflow: hidden;
			}

			/* Decorative Border */
			.certificate-border {
				position: absolute;
				top: 15mm;
				left: 15mm;
				right: 15mm;
				bottom: 15mm;
				border: 3px solid var(--primary-color);
				border-radius: 8px;
			}

			.certificate-border::before {
				content: '';
				position: absolute;
				top: -8px;
				left: -8px;
				right: -8px;
				bottom: -8px;
				border: 1px solid var(--accent-color);
				border-radius: 12px;
			}

			/* Corner Decorations */
			.corner-decoration {
				position: absolute;
				width: 60px;
				height: 60px;
				background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
				clip-path: polygon(0 0, 100% 0, 0 100%);
			}

			.corner-decoration.top-left { top: 15mm; left: 15mm; }
			.corner-decoration.top-right { top: 15mm; right: 15mm; transform: rotate(90deg); }
			.corner-decoration.bottom-left { bottom: 15mm; left: 15mm; transform: rotate(-90deg); }
			.corner-decoration.bottom-right { bottom: 15mm; right: 15mm; transform: rotate(180deg); }

			/* Content Wrapper */
			.certificate-content {
				padding: 12mm 15mm 8mm 15mm;
				position: relative;
				z-index: 2;
				height: 297mm;
				display: flex;
				flex-direction: column;
			}

			/* Header Section */
			.certificate-header {
				text-align: center;
				margin-bottom: 10px;
				padding-bottom: 10px;
				margin-top: 50px;
			}

			.logo-section {
				display: flex;
				align-items: center;
				justify-content: center;
				margin-bottom: 8px;
				gap: 20px;
			}

			.logo-image {
				width: 70px;
				height: 70px;
				object-fit: contain;
				filter: drop-shadow(0 2px 8px rgba(0,0,0,0.1));
				flex-shrink: 0;
			}

			.company-name {
				text-align: left;
				display: flex;
				flex-direction: column;
			}

			.company-name h1 {
				font-family: 'Playfair Display', serif;
				font-size: 22px;
				font-weight: 700;
				color: var(--primary-color);
				margin: 0;
				text-transform: uppercase;
				letter-spacing: 1px;
			}

			.company-name h2 {
				font-size: 14px;
				font-weight: 500;
				color: var(--secondary-color);
				margin: 0;
				text-transform: uppercase;
				letter-spacing: 2px;
			}

			/* Certificate Title */
			.certificate-title {
				margin: 10px 0;
			}

			.certificate-title h1 {
				font-family: 'Playfair Display', serif;
				font-size: 28px;
				font-weight: 700;
				color: var(--secondary-color);
				text-transform: uppercase;
				letter-spacing: 2px;
				margin-bottom: 5px;
			}

			.certificate-subtitle {
				font-size: 16px;
				color: var(--text-light);
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 1px;
			}

			/* Main Content */
			.certificate-body {
				flex: 1;
				display: flex;
				flex-direction: column;
				justify-content: flex-start;
				text-align: center;
				padding: 8px 0;
				margin-bottom: -20px;
			}

			.attestation-text {
				font-size: 18px;
				font-weight: 600;
				color: var(--secondary-color);
				margin-bottom: 8px;
				text-transform: uppercase;
				letter-spacing: 1px;
			}

			.student-name {
				font-family: 'Playfair Display', serif;
				font-size: 36px;
				font-weight: 700;
				color: var(--primary-color);
				margin: 8px 0;
				
				text-transform: capitalize;
			}

			/* Student Details Grid */
			.student-details {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 10px;
				margin: 12px 30px;
				padding: 10px;
				background: white;
				border-radius: 12px;
			}

			.detail-item {
				display: flex;
				flex-direction: column;
				align-items: center;
				padding: 6px;
				background: white;
				border-radius: 8px;
			}

			.detail-label {
				font-size: 12px;
				font-weight: 600;
				color: var(--text-light);
				text-transform: uppercase;
				letter-spacing: 1px;
				margin-bottom: 6px;
			}

			.detail-value {
				font-size: 14px;
				font-weight: 600;
				color: var(--text-dark);
				text-decoration: underline;
				text-decoration-color: var(--primary-color);
				text-decoration-thickness: 2px;
				text-underline-offset: 4px;
			}

			.matricule-value {
				font-family: 'Courier New', monospace;
				letter-spacing: 2px;
				text-transform: uppercase;
			}

			/* Internship Description */
			.internship-description {
				margin: 12px 30px 20px 30px;
				padding: 15px;
				background: white;
				text-align: justify;
				line-height: 1.6;
				font-size: 14px;
			}

			.hub-highlight {
				font-weight: 700;
				color: var(--primary-color);
				text-decoration: underline;
			}

			.name-highlight {
				font-weight: 700;
				color: var(--secondary-color);
				text-transform: capitalize;
			}

			/* Footer Section */
			.certificate-footer {
				margin-top: auto;
				padding-top: 0px;
				margin-bottom: 10mm;
				margin-left: 30px;
				margin-right: 30px;
			}

			.date-location {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 12px;
				font-size: 14px;
				font-weight: 500;
				width: 100%;
			}

			.signature-section {
				text-align: center;
				margin-bottom: 8px;
			}

			.signature-line {
				width: 150px;
				height: 2px;
				background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
				margin: 0 auto 5px;
				border-radius: 2px;
			}

			.signature-title {
				font-size: 12px;
				font-weight: 600;
				color: var(--text-light);
				text-transform: uppercase;
				letter-spacing: 1px;
			}

			/* Contact Information */
			.contact-info {
				background: white;
				color: var(--text-dark);
				padding: 15px;
				border-radius: 8px;
				margin-top: 8px;
			}

			.contact-grid {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 12px;
				font-size: 12px;
			}

			.contact-item {
				display: flex;
				align-items: center;
				gap: 8px;
				padding: 8px;
				background: rgba(40, 51, 81, 0.02);
				border-radius: 6px;
				border-left: 3px solid var(--primary-color);
			}

			.contact-item .icon {
				font-weight: bold;
				color: var(--primary-color);
				font-size: 14px;
				width: 16px;
				text-align: center;
			}

			.contact-item a {
				color: var(--secondary-color);
				text-decoration: none;
				font-weight: 500;
			}

			.contact-item a:hover {
				text-decoration: underline;
				color: var(--primary-color);
			}

			.contact-item span:not(.icon) {
				color: var(--secondary-color);
				font-weight: 500;
			}

			/* Print Styles */
			@media print {
				@page {
					size: A4;
					margin: 5mm !important;
					-webkit-print-color-adjust: exact;
					print-color-adjust: exact;
				}

				* {
					-webkit-print-color-adjust: exact !important;
					print-color-adjust: exact !important;
				}

				body {
					background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
					margin: 0 !important;
					padding: 0 !important;
				}

				/* Hide notifications in print */
				div[style*="position: fixed"] {
					display: none !important;
				}

				.certificate-container {
					margin: 0 !important;
					max-width: 200mm !important;
					min-height: 287mm !important;
					height: 287mm !important;
					box-shadow: none !important;
				}

				.certificate-content {
					padding: 12mm 15mm 8mm 15mm !important;
					height: 287mm !important;
				}

				/* Remove all background colors and gradients for clean print */
				.student-details,
				.detail-item,
				.internship-description,
				.contact-info,
				.contact-item {
					background: white !important;
					box-shadow: none !important;
				}

				.contact-info {
					border: 1px solid var(--text-dark) !important;
				}

				.contact-item {
					border-left: 2px solid var(--text-dark) !important;
					background: white !important;
				}

				.contact-item a,
				.contact-item span:not(.icon) {
					color: var(--text-dark) !important;
				}

				.contact-item .icon {
					color: var(--text-dark) !important;
				}

				/* Force grid layout for student details */
				.student-details {
					display: grid !important;
					grid-template-columns: 1fr 1fr !important;
					gap: 15px !important;
				}

				.detail-item {
					display: flex !important;
					flex-direction: column !important;
					align-items: center !important;
				}

				/* Ensure no column breaks */
				.student-details,
				.detail-item {
					page-break-inside: avoid !important;
					break-inside: avoid !important;
				}

				/* Keep contact grid layout in print */
				.contact-grid {
					display: grid !important;
					grid-template-columns: 1fr 1fr !important;
					gap: 8px !important;
				}

				.contact-item {
					display: flex !important;
					align-items: center !important;
				}
			}

			/* Responsive Design */
			@media (max-width: 768px) {
				.certificate-container {
					margin: 10px;
					max-width: calc(100% - 20px);
				}

				.certificate-content {
					padding: 20px 15px;
				}

				.company-name h1 {
					font-size: 24px;
				}

				.certificate-title h1 {
					font-size: 28px;
				}

				.student-name {
					font-size: 36px;
				}

				.student-details {
					grid-template-columns: 1fr;
					gap: 15px;
				}

				.logo-section {
					flex-direction: row;
					gap: 15px;
					justify-content: center;
				}

				.date-location {
					flex-direction: row;
					justify-content: space-between;
					gap: 15px;
					text-align: left;
				}

				.contact-grid {
					grid-template-columns: 1fr;
					gap: 8px;
				}

				.contact-item {
					justify-content: flex-start;
				}
			}
		</style>
	</head>
	<body>
		<div class="certificate-container">
			<!-- Decorative Border -->
			<div class="certificate-border"></div>
			
			<!-- Corner Decorations -->
			<div class="corner-decoration top-left"></div>
			<div class="corner-decoration top-right"></div>
			<div class="corner-decoration bottom-left"></div>
			<div class="corner-decoration bottom-right"></div>

			<div class="certificate-content">
				<!-- Header Section -->
				<header class="certificate-header">
					<div class="logo-section">
						<img src="img/lss-removebg-preview.png" alt="LSS Logo" class="logo-image" />
						<div class="company-name">
							<h1>Landmark Software Solutions</h1>
						</div>
					</div>
					
					<div class="certificate-title">
						<h1>Certificate of Internship</h1>
						<p class="certificate-subtitle">Attestation</p>
					</div>
				</header>

				<!-- Main Content -->
				<main class="certificate-body">
					<p class="attestation-text">This is to certify that</p>
					
					<h2 class="student-name" id="fullName">Student Name</h2>

					<div class="student-details">
						<div class="detail-item">
							<span class="detail-label">Born on</span>
							<span class="detail-value" id="dateOfBirth">Date</span>
						</div>
						<div class="detail-item">
							<span class="detail-label">At</span>
							<span class="detail-value" id="placeOfBirth">Place</span>
						</div>
						<div class="detail-item">
							<span class="detail-label">Matricule Number</span>
							<span class="detail-value matricule-value" id="matricule">Matricule</span>
						</div>
						<div class="detail-item">
							<span class="detail-label">Specialty</span>
							<span class="detail-value" id="department">Department</span>
						</div>
					</div>

					<div class="internship-description">
						<p>has successfully completed a <strong>Two (02) months Internship</strong> from <strong>July 1st to September 2025</strong> within the <span class="hub-highlight" id="hub">Program Name</span> hub at Landmark Software Solutions. During this period, <span class="name-highlight" id="name">Student</span> played a crucial role in the company's IT initiatives, actively contributing to the planning, development, and deployment of computerized solutions. Their involvement encompassed strategic planning, hands-on development, and successful deployment, providing the company with valuable insights and enhancing their skills in managing real-world IT projects.</p>
					</div>
				</main>

				<!-- Footer Section -->
				<footer class="certificate-footer">
					<div class="date-location">
						<span><strong>Done at:</strong> Buea, Cameroon</span>
						<span><strong>Date:</strong> <span id="stored-date">Current Date</span></span>
					</div>

					<div class="signature-section">
						<div class="signature-line"></div>
						<p class="signature-title">Director</p>
					</div>

					<div class="contact-info">
						<div class="contact-grid">
							<div class="contact-item">
								<span class="icon">üìû</span>
								<span>+1(437)221-3099 | +1(647)267-6399</span>
							</div>
							<div class="contact-item">
								<span class="icon">üåê</span>
								<a href="#">landmarksolution.cm</a>
							</div>
							<div class="contact-item">
								<span class="icon">üìû</span>
								<span>+1(437)213-2483 | +1(470)483-2473</span>
							</div>
							<div class="contact-item">
								<span class="icon">‚úâÔ∏è</span>
								<a href="#">litdirectorate@landmark.cm</a>
							</div>
						</div>
					</div>
				</footer>
			</div>
		</div>

		<script>
			// Enhanced certificate generation with improved error handling
			document.addEventListener('DOMContentLoaded', function() {
				// Smooth page load animation
				document.body.style.opacity = '0';
				document.body.style.transition = 'opacity 0.8s ease-out';
				
				setTimeout(() => {
					document.body.style.opacity = '1';
				}, 100);

				// Populate certificate with data
				populateCertificate();
			});

			function populateCertificate() {
				try {
					// Get data from localStorage
					const studentData = {
						names: window.localStorage.getItem('full-name'),
						date: window.localStorage.getItem('date-birth'),
						place: window.localStorage.getItem('place-birth'),
						matricule: window.localStorage.getItem('matricule-value'),
						department: window.localStorage.getItem('department-value'),
						hub: window.localStorage.getItem('hub')
					};

					// Validate data exists
					const missingFields = Object.entries(studentData)
						.filter(([key, value]) => !value || value.trim() === '')
						.map(([key]) => key);

					if (missingFields.length > 0) {
						showErrorAndRedirect();
						return;
					}

					// Populate fields with animation
					const fields = [
						{ id: 'fullName', value: studentData.names },
						{ id: 'placeOfBirth', value: studentData.place },
						{ id: 'dateOfBirth', value: formatDate(studentData.date) },
						{ id: 'matricule', value: studentData.matricule },
						{ id: 'department', value: studentData.department },
						{ id: 'hub', value: studentData.hub },
						{ id: 'name', value: studentData.names.split(' ')[0] }
					];

					fields.forEach((field, index) => {
						setTimeout(() => {
							const element = document.getElementById(field.id);
							if (element) {
								element.style.opacity = '0';
								element.textContent = field.value;
								element.style.transition = 'opacity 0.5s ease-in-out';
								setTimeout(() => {
									element.style.opacity = '1';
								}, 100);
							}
						}, index * 200);
					});

					// Set current date
					setTimeout(() => {
						const dateElement = document.getElementById('stored-date');
						if (dateElement) {
							const currentDate = new Date();
							const formattedDate = currentDate.toLocaleDateString('en-US', {
								weekday: 'long',
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							});
							
							dateElement.style.opacity = '0';
							dateElement.textContent = formattedDate;
							dateElement.style.transition = 'opacity 0.5s ease-in-out';
							setTimeout(() => {
								dateElement.style.opacity = '1';
							}, 100);
						}
					}, fields.length * 200);

					// Auto-print after all data is loaded
					setTimeout(() => {
						showPrintNotification();
						// Clear localStorage after successful population
						window.localStorage.clear();
						// Trigger print dialog
						setTimeout(() => {
							window.print();
						}, 2000);
					}, (fields.length + 1) * 200 + 1000);

				} catch (error) {
					console.error('Error populating certificate:', error);
					showErrorAndRedirect();
				}
			}

			function formatDate(dateString) {
				try {
					const date = new Date(dateString);
					return date.toLocaleDateString('en-US', {
						year: 'numeric',
						month: 'long',
						day: 'numeric'
					});
				} catch (error) {
					return dateString; // Return original if formatting fails
				}
			}

			function showErrorAndRedirect() {
				document.body.innerHTML = `
					<div style="display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); font-family: 'Inter', sans-serif;">
						<div style="text-align: center; padding: 3em; border-radius: 16px; background: white; box-shadow: 0 10px 40px rgba(0,0,0,0.1); max-width: 500px;">
							<div style="width: 80px; height: 80px; background: linear-gradient(135deg, #dc3545, #c82333); border-radius: 50%; margin: 0 auto 1.5em; display: flex; align-items: center; justify-content: center; color: white; font-size: 2em;">‚ö†Ô∏è</div>
							<h2 style="color: #dc3545; margin-bottom: 1em; font-size: 1.5em;">Missing Information</h2>
							<p style="color: #666; margin-bottom: 2em; line-height: 1.6;">Please complete the registration form first to generate your internship certificate.</p>
							<button onclick="window.location.href='index.html'" style="background: linear-gradient(135deg, #b53761 0%, #ef7d7a 100%); color: white; border: none; padding: 1em 2.5em; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1em; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(181, 55, 97, 0.3);">Return to Form</button>
						</div>
					</div>
				`;
			}

			function showPrintNotification() {
				const notification = document.createElement('div');
				notification.style.cssText = `
					position: fixed;
					top: 30px;
					right: 30px;
					background: linear-gradient(135deg, #28a745, #20c997);
					color: white;
					padding: 1.2em 2em;
					border-radius: 12px;
					z-index: 10000;
					box-shadow: 0 10px 40px rgba(0,0,0,0.2);
					font-family: 'Inter', sans-serif;
					font-weight: 500;
					animation: slideInRight 0.5s ease-out;
				`;
				notification.innerHTML = `
					<div style="display: flex; align-items: center; gap: 10px;">
						<span style="font-size: 1.2em;">‚úÖ</span>
						<span>Certificate ready! Print dialog opening...</span>
					</div>
				`;
				document.body.appendChild(notification);

				setTimeout(() => {
					notification.style.animation = 'slideOutRight 0.5s ease-in';
					setTimeout(() => notification.remove(), 500);
				}, 3000);
			}

			// Add animation styles
			const style = document.createElement('style');
			style.textContent = `
				@keyframes slideInRight {
					from { transform: translateX(100%); opacity: 0; }
					to { transform: translateX(0); opacity: 1; }
				}
				@keyframes slideOutRight {
					from { transform: translateX(0); opacity: 1; }
					to { transform: translateX(100%); opacity: 0; }
				}
			`;
			document.head.appendChild(style);
		</script>
	</body>
</html>
